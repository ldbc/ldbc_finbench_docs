workload: Transaction
operation: complex-read
number: 9
title: Money laundering with loan involved
description: |
  Given an *account* and a specified time window between *start_time* and *end_time*, find the *despoit* and *repay* edge between the *account*
  and a *loan*. Then calculate the amount ratio of *deposit* over *repay*, the
  amount ratio of *transfers-in* over *transfers-out*, the amount ratio of
  *deposit* over *transfers-out*. Return the ratios.
parameters:
  - name: threshold
    type: 64-bit Integer
    description: threshold of amount
  - name: lowerbound
    type: 32-bit float
    description: lower threshold bound of the ratio of repay over deposit
  - name: upperbound
    type: 32-bit float
    description: upper threshold bound of the ratio of repay over deposit
  - name: start_time
    type: DateTime
    description: begin of the time window
  - name: end_time
    type: DateTime
    description: end of the time window
result:
  - name: SUM(edge1)/SUM(edge2)
    type: 32-bit float
    category: calculated
  - name: SUM(edge1)/SUM(edge4)
    type: 32-bit float
    category: calculated
  - name: SUM(edge3)/SUM(edge4)
    type: 32-bit float
    category: calculated
choke_points: []
relevance: |
  This query is money laundering with loans involved recognition in AWL.